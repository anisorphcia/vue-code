{"version":3,"file":"vue.js","sources":["../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["// 获取数组的方法\r\nlet oldArrayProtoMethods = Array.prototype\r\nconsole.log('oldArrayProtoMethods', oldArrayProtoMethods)\r\n// 继承\r\nexport let ArrayMethods = Object.create(oldArrayProtoMethods)\r\nconsole.log('ArrayMethods', ArrayMethods)\r\n// 劫持\r\nlet methods = [\r\n    \"push\",\r\n    \"pop\",\r\n    \"unshift\",\r\n    \"shift\",\r\n    \"splice\"\r\n]\r\n\r\nmethods.forEach(item => {\r\n    console.log('ArrayMethods[item]', ArrayMethods[item])\r\n    ArrayMethods[item] = function(...args){\r\n        console.log('劫持数组')\r\n       let result = oldArrayProtoMethods[item].apply(this, args) // this -> list:[]\r\n       return result\r\n    }\r\n})\r\n","import { ArrayMethods } from './arr'\r\n\r\nexport function observer(data){\r\n    if(typeof data !== 'object' || data === null){\r\n        return data;\r\n    }\r\n    return new Observer(data)\r\n}\r\n\r\nclass Observer{\r\n    constructor(value){\r\n        if (Array.isArray(value)){\r\n            console.log('array', value)\r\n            value.__proto__ = ArrayMethods\r\n        } else {\r\n            this.walk(value)\r\n        }\r\n    }\r\n    walk(data){\r\n        let keys = Object.keys(data)\r\n        for(let i = 0; i < keys.length; ++i){\r\n            let key = keys[i]\r\n            let value = data[key]\r\n            defineReactive(data, key, value)\r\n        }\r\n    }\r\n}\r\n\r\n// 只能对对象中的属性劫持，无法操作数组\r\nfunction defineReactive(data, key, value){\r\n    observer(value)\r\n    Object.defineProperty(data, key, {\r\n        get(){\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue === value) return\r\n            value = newValue\r\n        }\r\n    })\r\n}","import { observer } from \"./observe/index\"\r\n\r\nexport function initState(vm){\r\n    let opts = vm.$options\r\n    if(opts.data){\r\n        initData(vm)\r\n    }\r\n}\r\n\r\nfunction initData(vm){\r\n    let data = vm.$options.data\r\n    // data() 指向window\r\n    // data.call(vm) 改变this指向\r\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\r\n    // 数据劫持\r\n    observer(data)   \r\n}","import { initState } from \"./initState\"\r\n\r\nexport function initMixin(Vue){\r\n    Vue.prototype._init = function(options){\r\n        console.log(options)\r\n        let vm = this\r\n        vm.$options = options\r\n        // init\r\n        initState(vm)\r\n    }\r\n}\r\n","import { initMixin } from \"./init\"\r\n\r\nfunction Vue(options){\r\n    this._init(options)\r\n}\r\n\r\ninitMixin(Vue)\r\n\r\nexport default Vue"],"names":["oldArrayProtoMethods","Array","prototype","console","log","ArrayMethods","Object","create","methods","forEach","item","_len","arguments","length","args","_key","result","apply","observer","data","_typeof","Observer","value","_classCallCheck","isArray","__proto__","walk","_createClass","key","keys","i","defineReactive","defineProperty","get","set","newValue","initState","vm","opts","$options","initData","_data","call","initMixin","Vue","_init","options"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA,IAAIA,oBAAoB,GAAGC,KAAK,CAACC,SAAS,CAAA;EAC1CC,OAAO,CAACC,GAAG,CAAC,sBAAsB,EAAEJ,oBAAoB,CAAC,CAAA;EACzD;EACO,IAAIK,YAAY,GAAGC,MAAM,CAACC,MAAM,CAACP,oBAAoB,CAAC,CAAA;EAC7DG,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEC,YAAY,CAAC,CAAA;EACzC;EACA,IAAIG,OAAO,GAAG,CACV,MAAM,EACN,KAAK,EACL,SAAS,EACT,OAAO,EACP,QAAQ,CACX,CAAA;EAEDA,OAAO,CAACC,OAAO,CAAC,UAAAC,IAAI,EAAI;IACpBP,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEC,YAAY,CAACK,IAAI,CAAC,CAAC,CAAA;EACrDL,EAAAA,YAAY,CAACK,IAAI,CAAC,GAAG,YAAiB;EAClCP,IAAAA,OAAO,CAACC,GAAG,CAAC,MAAM,CAAC,CAAA;EAAA,IAAA,KAAA,IAAAO,IAAA,GAAAC,SAAA,CAAAC,MAAA,EADUC,IAAI,GAAAb,IAAAA,KAAA,CAAAU,IAAA,GAAAI,IAAA,GAAA,CAAA,EAAAA,IAAA,GAAAJ,IAAA,EAAAI,IAAA,EAAA,EAAA;EAAJD,MAAAA,IAAI,CAAAC,IAAA,CAAAH,GAAAA,SAAA,CAAAG,IAAA,CAAA,CAAA;EAAA,KAAA;EAElC,IAAA,IAAIC,MAAM,GAAGhB,oBAAoB,CAACU,IAAI,CAAC,CAACO,KAAK,CAAC,IAAI,EAAEH,IAAI,CAAC,CAAC;EAC1D,IAAA,OAAOE,MAAM,CAAA;KACf,CAAA;EACL,CAAC,CAAC;;ECpBK,SAASE,QAAQA,CAACC,IAAI,EAAC;IAC1B,IAAGC,OAAA,CAAOD,IAAI,CAAA,KAAK,QAAQ,IAAIA,IAAI,KAAK,IAAI,EAAC;EACzC,IAAA,OAAOA,IAAI,CAAA;EACf,GAAA;EACA,EAAA,OAAO,IAAIE,QAAQ,CAACF,IAAI,CAAC,CAAA;EAC7B,CAAA;EAAC,IAEKE,QAAQ,gBAAA,YAAA;IACV,SAAAA,QAAAA,CAAYC,KAAK,EAAC;EAAAC,IAAAA,eAAA,OAAAF,QAAA,CAAA,CAAA;EACd,IAAA,IAAIpB,KAAK,CAACuB,OAAO,CAACF,KAAK,CAAC,EAAC;EACrBnB,MAAAA,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEkB,KAAK,CAAC,CAAA;QAC3BA,KAAK,CAACG,SAAS,GAAGpB,YAAY,CAAA;EAClC,KAAC,MAAM;EACH,MAAA,IAAI,CAACqB,IAAI,CAACJ,KAAK,CAAC,CAAA;EACpB,KAAA;EACJ,GAAA;EAACK,EAAAA,YAAA,CAAAN,QAAA,EAAA,CAAA;MAAAO,GAAA,EAAA,MAAA;EAAAN,IAAAA,KAAA,EACD,SAAAI,IAAKP,CAAAA,IAAI,EAAC;EACN,MAAA,IAAIU,IAAI,GAAGvB,MAAM,CAACuB,IAAI,CAACV,IAAI,CAAC,CAAA;EAC5B,MAAA,KAAI,IAAIW,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,IAAI,CAAChB,MAAM,EAAE,EAAEiB,CAAC,EAAC;EAChC,QAAA,IAAIF,GAAG,GAAGC,IAAI,CAACC,CAAC,CAAC,CAAA;EACjB,QAAA,IAAIR,KAAK,GAAGH,IAAI,CAACS,GAAG,CAAC,CAAA;EACrBG,QAAAA,cAAc,CAACZ,IAAI,EAAES,GAAG,EAAEN,KAAK,CAAC,CAAA;EACpC,OAAA;EACJ,KAAA;EAAC,GAAA,CAAA,CAAA,CAAA;EAAA,EAAA,OAAAD,QAAA,CAAA;EAAA,CAGL,EAAA,CAAA;EACA,SAASU,cAAcA,CAACZ,IAAI,EAAES,GAAG,EAAEN,KAAK,EAAC;IACrCJ,QAAQ,CAACI,KAAK,CAAC,CAAA;EACfhB,EAAAA,MAAM,CAAC0B,cAAc,CAACb,IAAI,EAAES,GAAG,EAAE;MAC7BK,GAAG,EAAA,SAAAA,MAAE;EACD,MAAA,OAAOX,KAAK,CAAA;OACf;MACDY,GAAG,EAAA,SAAAA,GAACC,CAAAA,QAAQ,EAAC;QACT,IAAGA,QAAQ,KAAKb,KAAK,EAAE,OAAA;EACvBA,MAAAA,KAAK,GAAGa,QAAQ,CAAA;EACpB,KAAA;EACJ,GAAC,CAAC,CAAA;EACN;;ECtCO,SAASC,SAASA,CAACC,EAAE,EAAC;EACzB,EAAA,IAAIC,IAAI,GAAGD,EAAE,CAACE,QAAQ,CAAA;IACtB,IAAGD,IAAI,CAACnB,IAAI,EAAC;MACTqB,QAAQ,CAACH,EAAE,CAAC,CAAA;EAChB,GAAA;EACJ,CAAA;EAEA,SAASG,QAAQA,CAACH,EAAE,EAAC;EACjB,EAAA,IAAIlB,IAAI,GAAGkB,EAAE,CAACE,QAAQ,CAACpB,IAAI,CAAA;EAC3B;EACA;EACAA,EAAAA,IAAI,GAAGkB,EAAE,CAACI,KAAK,GAAG,OAAOtB,IAAI,KAAK,UAAU,GAAGA,IAAI,CAACuB,IAAI,CAACL,EAAE,CAAC,GAAGlB,IAAI,CAAA;EACnE;IACAD,QAAQ,CAACC,IAAI,CAAC,CAAA;EAClB;;ECdO,SAASwB,SAASA,CAACC,GAAG,EAAC;EAC1BA,EAAAA,GAAG,CAAC1C,SAAS,CAAC2C,KAAK,GAAG,UAASC,OAAO,EAAC;EACnC3C,IAAAA,OAAO,CAACC,GAAG,CAAC0C,OAAO,CAAC,CAAA;MACpB,IAAIT,EAAE,GAAG,IAAI,CAAA;MACbA,EAAE,CAACE,QAAQ,GAAGO,OAAO,CAAA;EACrB;MACAV,SAAS,CAACC,EAAE,CAAC,CAAA;KAChB,CAAA;EACL;;ECRA,SAASO,GAAGA,CAACE,OAAO,EAAC;EACjB,EAAA,IAAI,CAACD,KAAK,CAACC,OAAO,CAAC,CAAA;EACvB,CAAA;EAEAH,SAAS,CAACC,GAAG,CAAC;;;;;;;;"}